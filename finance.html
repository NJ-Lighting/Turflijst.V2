<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>💰 Finance | Turflijst</title>
  <link rel="stylesheet" href="/css/app.css" />
  <link rel="stylesheet" href="/css/nav.css" />
</head>
<body class="bg-train">
  <header class="site-nav" role="banner">
    <button class="nav-toggle" aria-controls="nav-drawer" aria-expanded="false" aria-label="Menu openen">☰</button>
    <nav id="nav-drawer" class="nav-drawer" role="navigation" aria-label="Hoofdnavigatie">
      <a href="/index.html">Home</a>
      <a href="/admin.html">Admin</a>
      <a href="/finance.html" aria-current="page">Finance</a>
      <a href="/stock.html">Voorraad</a>
      <a href="/history.html">History</a>
      <a href="/new-user.html">Nieuwe gebruiker</a>
    </nav>
  </header>

  <div class="content-wrapper">
    <h1>💰 Finance Overzicht</h1>

    <!-- KPI’s (snapshot + extra’s) -->
    <section class="cards grid">
      <div class="card kpi"><div class="lbl">Koelkastwaarde</div><div id="kpi-fridge" class="val">€0,00</div></div>
      <div class="card kpi"><div class="lbl">Voorgeschoten</div><div id="kpi-prepaid" class="val">€0,00</div></div>
      <div class="card kpi"><div class="lbl">Ontvangen</div><div id="kpi-received" class="val">€0,00</div></div>
      <div class="card kpi"><div class="lbl">Statiegeld ontvangen</div><div id="kpi-deposit-earned" class="val">€0,00</div></div>
      <div class="card kpi"><div class="lbl">Profit/Loss</div><div id="kpi-profit" class="val">€0,00</div></div>

      <div class="card kpi"><div class="lbl">Openstaand</div><div id="kpi-open" class="val">€0,00</div></div>
      <div class="card kpi"><div class="lbl">Omzet (all time)</div><div id="kpi-revenue" class="val">€0,00</div></div>
      <div class="card kpi"><div class="lbl">COGS (all time)</div><div id="kpi-cogs" class="val">€0,00</div></div>
      <div class="card kpi"><div class="lbl">Marge (all time)</div><div id="kpi-margin" class="val">€0,00</div></div>
    </section>

    <!-- Buffer -->
    <section class="cards grid">
      <div class="card kpi"><div class="lbl">Buffer in</div><div id="kpi-buffer-in" class="val">€0,00</div></div>
      <div class="card kpi"><div class="lbl">Buffer uit</div><div id="kpi-buffer-out" class="val">€0,00</div></div>
      <div class="card kpi"><div class="lbl">Buffer beschikbaar</div><div id="kpi-buffer-available" class="val">€0,00</div></div>
    </section>

    <!-- Statiegeld registreren -->
    <section class="card section">
      <h2>🏦 Statiegeld registreren</h2>
      <div class="row">
        <input id="deposit-amount" class="input" type="number" inputmode="decimal" step="0.01" placeholder="Bedrag in €" />
        <input id="deposit-note" class="input" type="text" placeholder="Opmerking (optioneel)" />
        <button id="btn-add-deposit" class="btn">Opslaan</button>
      </div>
    </section>

    <!-- Verkocht per product -->
    <section class="card section">
      <h2>📦 Verkocht per product</h2>
      <table class="table">
        <thead><tr><th>Product</th><th class="right">Aantal</th></tr></thead>
        <tbody id="tbl-sold-per-product"></tbody>
      </table>
    </section>

    <!-- Betalingen -->
    <section class="card section">
      <h2>💸 Betalingen</h2>
      <div class="row">
        <label for="filter-user" class="muted">Filter gebruiker</label>
        <select id="filter-user" class="select"></select>
      </div>
      <table class="table">
        <thead>
          <tr>
            <th>Datum</th>
            <th>Gebruiker</th>
            <th class="right">Bedrag</th>
            <th>Opmerking</th>
            <th>Actie</th>
          </tr>
        </thead>
        <tbody id="tbl-payments"></tbody>
      </table>
      <div class="row">
        <select id="pay-user" class="select" title="Gebruiker"></select>
        <input id="pay-amount" class="input" type="number" inputmode="decimal" step="0.01" placeholder="Bedrag in €" />
        <input id="p-note" class="input" type="text" placeholder="Opmerking (optioneel)" />
        <button id="btn-add-payment" class="btn">Betaling toevoegen</button>
      </div>
    </section>

    <!-- Openstaand per gebruiker -->
    <section class="card section">
      <h2>🧾 Openstaand per gebruiker</h2>
      <table class="table">
        <thead><tr><th>Gebruiker</th><th class="right">Aantal</th><th class="right">Bedrag</th></tr></thead>
        <tbody id="tbl-open-users"></tbody>
      </table>
    </section>

    <!-- Aging -->
    <section class="card section">
      <h2>⏳ Aging (onbetaald)</h2>
      <table class="table">
        <thead><tr><th>Bucket</th><th class="right">Bedrag</th></tr></thead>
        <tbody id="tbl-aging"></tbody>
      </table>
    </section>

    <!-- Maandoverzicht -->
    <section class="card section">
      <h2>📅 Maandoverzicht</h2>
      <table class="table">
        <thead>
          <tr>
            <th>Maand</th>
            <th class="right">Omzet</th>
            <th class="right">COGS</th>
            <th class="right">Marge</th>
            <th class="right">Betalingen</th>
            <th class="right">Deposits</th>
          </tr>
        </thead>
        <tbody id="month-stats"><tr><td colspan="6" class="muted">Wordt gevuld als data aanwezig is</td></tr></tbody>
      </table>
    </section>
  </div>

  <script type="module" src="/js/core.js"></script>
  <script type="module" src="/js/supabase.client.js"></script>
  <script type="module" src="/js/api/finance.js"></script>
  <script type="module" src="/js/pages/finance.page.js"></script>
  <script type="module" src="/js/nav.js"></script>
</body>
</html>
